@model IList<I_Facility.ServerModel.CellpartEdit>
@{
    ViewBag.title = "Edit";
    var i = 0;
    var Count = ViewBag.item;
}


<div class="right_col" role="main">
    <div class="">
        <div class="page-title">
            <div class="title_left">
                <h3>Edit Cell Details</h3>
            </div>
        </div>
        <div class="clearfix"></div>
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>Edit Cell Details</h2>
                        <ul class="nav navbar-right panel_toolbox">
                            <li>
                                <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">

                        @using (Html.BeginForm("Edit", "Cells", FormMethod.Post))
                        {
                            <form class="form-horizontal form-label-left" novalidate>
                                <div class="control-group" id="fields">
                                    <div class="controls">
                                        <div class="form">
                                            <div class="entry input-group col-sm-12">
                                                <div class="item form-group">
                                                    @foreach (var item in Model)
                                                    {
                                                        if (item.cell != null)
                                                        {
                                                            <label class="control-label col-md-1 col-sm-3 col-xs-12">Plant Name</label>
                                                            <div class="col-md-3 col-sm-6 col-xs-12">
                                                                @Html.DropDownList("Plant", null, "--Select Plant--", new { @id = "PlantID", @class = "form-control ", @name = "Plant", @required = "required", @style = "aria-expanded:false;width:89.7%", @value = "@ViewData['Plant']", @onchange = "changeplantstatus();" })
                                                                @Html.HiddenFor(model => item.cell.PlantID, new { @id = "PlantiD" })
                                                                <span id="messageSpan" style="color:red"></span>
                                                            </div>
                                                            <label class="control-label col-md-1 col-sm-3 col-xs-12">Shop Name</label>
                                                            <div class="col-md-3 col-sm-6 col-xs-12">
                                                               
                                                                @Html.DropDownList("shop", null, "--Select Department--", new { @id = "Editdeptid", @class = "form-control", @name = "dept", @required = "required", @style = "aria-expanded:false;width:89.7%", @value = "@ViewData['shop']", @onchange = "changedeptstatus();" })
                                                                 @Html.HiddenFor(model => item.cell.ShopID, new { @id = "ShopiD" })
                                                            </div>
                                                            <label class="control-label col-md-1 col-sm-3 col-xs-12">Cell Name</label>
                                                            <div class="col-md-3 col-sm-6 col-xs-12">

                                                                @Html.TextBoxFor(model => item.cell.CellName, new { @id = "EditCellCategory", @class = "form-control", @name = "CellName", style = "width:89.7%", @placeholder = "Enter Cell Name", @required = "required", @*@onchange = "cellNameCheckEdit();", @oninput = "cellNameCheckEdit();",*@@onchange = "changecellstatus();"
                                                            })
                                                                @Html.HiddenFor(model => item.cell.CellID, new { @id = "EditCellCategoryID", @class = "form-control", @name = "CellName", style = "width:89.7%", @placeholder = "Enter Cell Name", @required = "required" })
                                                            </div>
                                                            <label class="control-label col-md-1 col-sm-3 col-xs-12">Cell Description</label>
                                                            <div class="col-md-3 col-sm-6 col-xs-12">

                                                                @Html.TextBoxFor(model => item.cell.CellDesc, new { @id = "EditCategoryDesc", @class = "form-control", @name = "CellDesc", style = "width:89.7%", @placeholder = "Enter Cell Description", @required = "required", @onchange = "changecatdesc();" })
                                                                @Html.HiddenFor(model => item.cell.CellDesc, new { @id = "EditCategoryDesc1" })
                                                            </div>
                                                            <label class="control-label col-md-1 col-sm-3 col-xs-12">Cell Display Name</label>
                                                            <div class="col-md-3 col-sm-6 col-xs-12">

                                                                @Html.TextBoxFor(model => item.cell.CelldisplayName, new { @id = "EditCategoryDisplayName", @class = "form-control", @name = "CategoryDisplayName", style = "width:89.7%", @placeholder = "Enter Cell Description", @required = "required", @onchange = "changecatdisp();" })

                                                                @Html.HiddenFor(model => item.cell.CelldisplayName, new { @id = "EditCategoryDisplayName1" })
                                                            </div>
                                                            <label class="control-label col-md-1 col-sm-3 col-xs-12">No Of Model</label>
                                                            <div class="col-md-3 col-sm-6 col-xs-12">

                                                                @Html.TextBoxFor(model => item.cell.NoofModel, new { @id = "EditNo_Of_Model", @class = "form-control", @name = "No Of Model", style = "width:89.7%", @placeholder = "Enter No Of Model", @required = "required", @onchange = "changenoofmodel();" })
                                                                @Html.HiddenFor(model => item.cell.NoofModel, new { @id = "EditNo_Of_Model1" })
                                                            </div>
                                                        }
                                                        @Html.HiddenFor(model => item.cell.CreatedBy, new { @id = "CreatedBy" })
                                                        @Html.HiddenFor(model => item.cell.CreatedOn, new { @id = "CreatedOn" })
                                                        @Html.HiddenFor(model => item.cell.ModifiedBy, new { @id = "ModifiedBy" })
                                                        @Html.HiddenFor(model => item.cell.ModifiedOn, new { @id = "ModifiedOn" })
                                                        @Html.HiddenFor(model => item.cell.IsDeleted, new { @id = "IsDeleted" })
                                                    }

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="generate-btn">

                                    <a id="" href="/Cells/CellsList" type="submit" class="btn btn-new"><i class="fa fa-chevron-left" aria-hidden="true"></i>&nbsp;Back</a>
                                    <button type="submit" class="btn btn-new float-right catagorydet"><i class="fa fa-floppy-o" aria-hidden="true"></i>&nbsp;Update</button>
                                </div>
                            </form>
                        }
                        @using (Html.BeginForm("Edit", "Cells", FormMethod.Post))
                        {
                            <div class="clearfix"></div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="x_panel">
                                        <div class="x_title">
                                            <h2>Edit Parts Details</h2>
                                            <ul class="nav navbar-right panel_toolbox">
                                                <li>
                                                    <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                                                </li>
                                            </ul>
                                            <div class="clearfix"></div>
                                        </div>
                                        <div class="x_content">
                                            @foreach (var item in Model)
                                            {
                                                if(item.cellpart!= null)
                                                //for (i = 0; i < Count; i++)
                                                {
                                                    <label class="col-sm-new-3 control-label">Part No</label>
                                                    <div class="col-sm-new-3">

                                                        @Html.TextBoxFor(modelItem => item.cellpart.partNo, new { @id = "EditpartNo", @value = "partNo", @class = "form-control", @name = "partNo", @placeholder = "Enter partNo", @required = "required", @onchange = "changepartno();" })
                                                        @Html.HiddenFor(model => item.cellpart.partNo, new { @id = "partNo" })
                                                    </div>
                                                    <label class="col-sm-new-4 control-label">Part Description</label>
                                                    <div class="col-sm-new-3">

                                                        @Html.TextBoxFor(modelItem => item.cellpart.PartDescription, new { @id = "EditPartDescription", @value = "PartDescription", @class = "form-control", @name = "PartDescription", @placeholder = "Enter PartDescription", @required = "required", @onchange = "changepartdesc();" })
                                                        @Html.HiddenFor(model => item.cellpart.PartDescription, new { @id = "PartDescription" })
                                                        <span id="errorMessage" style="color:red"></span>
                                                    </div>
                                                    <div class="actionbtnn">
                                                        @*<button class="btn btn-round btn-danger deleteItem"></button>*@
                                                        @*<button class="btn btn-round btn-danger deleteItem" data-id="@Model.cellpart.partNo" onclick="deleteTargetName('@Model.cellpart.partNo')" data-title="Edit" data-toggle="modal" data-target="#delete-plant"><i class="fa fa-trash fa-lg" aria-hidden="true" data-placement="top" data-toggle="tooltip" title="Delete Cell Details"></i></button></li>*@
                                                        <button class="btn btn-danger deleteItem" data-id="@item.cellpart.cpID" onclick="deleteTargetName('@item.cellpart.cpID')" data-title="Edit" data-toggle="modal" data-target="#delete-part"><i class="fa fa-trash fa-lg" aria-hidden="true" data-placement="top" data-toggle="tooltip" title="Delete Part details"></i></button>
                                                    </div>
                                                }
                                               
                                                @Html.HiddenFor(model => item.cellpart.cpID, new { @id = "cpID" })
                                                @Html.HiddenFor(model => item.cellpart.CreatedBy, new { @id = "CreatedBy" })
                                                @Html.HiddenFor(model => item.cellpart.CreatedOn, new { @id = "CreatedOn" })
                                                @Html.HiddenFor(model => item.cellpart.IsDeleted, new { @id = "IsDeleted" })
                                            }


                                        </div>
                                    </div>
                                    <div class="generate-btn">
                                        <a id="" href="/Cells/CellsList" type="submit" class="btn btn-new"><i class="fa fa-chevron-left" aria-hidden="true"></i>&nbsp;Back</a>
                                        <button type="submit" class="btn btn-new float-right partdet"><i class="fa fa-floppy-o" aria-hidden="true"></i>&nbsp;Update</button>

                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Modal Start -->
<div class="modal fade" id="delete-part" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel"></h4>
                <div class="x_panel">
                    <div class="x_title">
                        <h5>Delete Part Details</h5>
                    </div>
                    <div class="x_content">
                        <div class="alert alert-danger">
                            <span class="glyphicon glyphicon-warning-sign"></span> Are you sure you want to delete this Detail?<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="alert-danger11">Part Number:</label>
                            <br />
                            <span id="childSpan" style="white-space: pre-line;line-height: 8px;"></span>
                        </div>

                    </div>
                </div>
            </div>
            <div class="modal-footer">
                @*Html.ActionLink("Yes", "DeleteShops", "Shops", new { id = item.ShopID }, new { @class = "btn btn-danger btnContinueDelete" })*@
                <button type="button" class="btn btn-danger btnContinueDelete"><span class="glyphicon glyphicon-ok-sign"></span> Yes</button>
                <button type="button" class="btn btn-info" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> No</button>
            </div>
        </div>
    </div>
</div>
<!-- Delete Modal Finish -->
<script src="~/js/jquery-2.1.4.min.js"></script>

@if (TempData["Message"] != null)
{
    <input type="hidden" id="Message" value="@TempData["Message"]" />
    <script type="text/javascript">
        $(function () {
            var message = $("#Message").val();
            if (message !== "") {
                $("#errorMessage").html(message);
                
            }
        });
        
    </script>
}

<script>
    function cellNameCheckEdit() {
        var cellName = $("#EditCellCategory").val();
        var PlantID = $("#EditPlant").val();
        var shopId = $("#Editdeptid").val();
        var EditCellCategoryID = $("#EditCellCategoryID").val();
        $.ajax({
            type: "POST",
            data: { 'plantID': PlantID, 'shopId': shopId, 'cellName': cellName, 'editCellID': EditCellCategoryID },
            url: "/Cells/CellNameDuplicateCheckEdit",
            async: false,
            success: function (data) {
                if (data === "notok") {
                    $("#plantErrorEdit").html('Cell already exists');
                    $("#btnSubmitEdit").attr('disabled', 'disabled');
                } else {
                    $("#plantErrorEdit").html('');
                    $("#btnSubmitEdit").removeAttr('disabled', 'disabled');
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert("", "There is some issue in network");
            }
        });
    }
</script>


<script type="text/javascript">
    $(document).ready(function () {
        $('#EditCellCategory').change(function () {
            var val = $('#EditCellCategory').val();
            $('#EditCategoryDisplayName').val(val);
        });
    });
</script>
<script>
    setTimeout(function () {
        $('#Error').fadeOut('slow');
    }, 15000); // <-- time in milliseconds
</script>
<script>
    $(".Category").on("click", function (e) {
        $(".Cell").click();

        e.preventDefault();
        var CellCategoryID = $(this).attr("id")
        //alert(CellCategoryID)
        $.getJSON("/Cells/CellCategoryById", { Id: CellCategoryID }, function (data) {
            $.each(data, function (index, item) {
                $("#EditCellCategoryID").val(CellCategoryID);
                $("#EditPlant").val((item.PlantId));
                $("#Editdeptid").val((item.DepartmentId));
                $("#EditCellCategory").val((item.machinecategory));
                $("#EditCategoryDesc").val((item.catdesc));
                $("#EditCategoryDisplayName").val((item.catdeisplay));
                $("#EditNo_Of_Model").val((item.noofmodel));
                var PID = item.PlantId;
                $.getJSON("/Cells/FetchDept", { PID: PID }, function (data) {
                    $("#Editdeptid").empty();
                    $("#Editdeptid").append("<option value = ''> --Select Department-- </option>")
                    $.each(data, function (index, item) {
                        $("#Editdeptid").append("<option value = '" + item.Value + "'>" + item.Text + "</option>")
                    });
                    $("#Editdeptid").val(item.DepartmentId);
                });

            })
        })
    })

</script>
<script>
    $(".modal-header").on("click", function (e) {
        $(".Category").click();
        var CellCategoryID = $(this).attr("id")
        $.getJSON("/Cells/PartById", { Id: CellCategoryID }, function (data) {
            $.each(data, function (index, item) {
                $("#EditpartNo").val(item.partno);
                $("#EditPartDescription").val((item.partdesc));
            });
        });
    });

</script>
<script>
    $("#div2").children().attr("disabled", "disabled");
</script>
<script>

    function deleteTargetName(item_to_delete) {
        //alert (productvariant);
        $(".deleteTargetName").empty();
        $(".alert-danger11").html("cpID: " +
            item_to_delete);

    }

    var item_to_delete;
    $(".deleteItem").click(function (e) {
        item_to_delete = $(this).data('id');
        //alert(item_to_delete);
    });
    $('.btnContinueDelete').click(function () {
        window.location = "/Cells/DeleteParts/" + "?id=" + item_to_delete;
    });

</script>

<script>
    function changeplantstatus() {
        var plantID = $("#PlantID").val();
        $("#PlantiD").val(plantID);
    }
    function changedeptstatus() {
        var shopid = $("#Editdeptid").val();
        $("#ShopiD").val(shopid);
    }
    function changecellstatus() {
        var cellcat = $("#EditCellCategory").val();
        $("#EditCellCategoryID").val(cellcat);
    }
    function changecatdesc() {
        var catdesc = $("#EditCategoryDesc").val();
        $("#EditCategoryDesc1").val(catdesc);
    }
    function changecatdisp() {
        var catdisp = $("#EditCategoryDisplayName").val();
        $("#EditCategoryDisplayName1").val(catdisp);
    }
    function changenoofmodel() {
        var noofmodel = $("#EditNo_Of_Model").val();
        $("#EditNo_Of_Model1").val(noofmodel);
    }
    function changepartno() {
        var partno = $("#EditpartNo").val();
        $("#partNo").val(partno);

    }
    function changepartdesc() {
        var partdesc = $("#EditPartDescription").val();
        $("#PartDescription").val(partdesc);
    }
    </script>